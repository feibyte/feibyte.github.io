<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="robots" content="noindex"><meta name="google-site-verification" content="aG_tXROG9wF9yK4g29KmnltUUXyLK5SBAWKIXDkz6vU"><title>Tag: Serviceless - Fedeoo&#039;s Blog</title><link rel="manifest" href="/en/manifest.json"><meta name="application-name" content="Fedeoo&#039;s Blog"><meta name="msapplication-TileImage" content="/gallery/site/shark.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Fedeoo&#039;s Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="博客主要记录工作上的实践总结和技术思考"><meta property="og:type" content="blog"><meta property="og:title" content="Fedeoo&#039;s Blog"><meta property="og:url" content="http://blog.feibyte.com/en"><meta property="og:site_name" content="Fedeoo&#039;s Blog"><meta property="og:description" content="博客主要记录工作上的实践总结和技术思考"><meta property="og:locale" content="en_US"><meta property="og:image" content="http://blog.feibyte.com/en/img/og_image.png"><meta property="article:author" content="Fedeoo"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="http://blog.feibyte.com/en/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://blog.feibyte.com/en"},"headline":"Fedeoo's Blog","image":["http://blog.feibyte.com/en/img/og_image.png"],"author":{"@type":"Person","name":"Fedeoo"},"publisher":{"@type":"Organization","name":"Fedeoo's Blog","logo":{"@type":"ImageObject","url":"http://blog.feibyte.com/gallery/site/logo.png"}},"description":"博客主要记录工作上的实践总结和技术思考"}</script><link rel="icon" href="/en/gallery/site/shark.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/en/css/default.css"><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=G-773NDPTQE0" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'G-773NDPTQE0');</script><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.2.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/en/"><img src="/en/gallery/site/logo.png" alt="Fedeoo&#039;s Blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/en/">Home</a><a class="navbar-item" href="/en/archives">Archives</a><a class="navbar-item" href="/en/categories">Categories</a><a class="navbar-item" href="/en/tags">Tags</a><a class="navbar-item" href="/en/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="简体中文" href="https://blog.feibyte.com/">简体中文</a><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/feibyte/feibyte.github.io"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/en/tags">Tags</a></li><li class="is-active"><a href="#" aria-current="page">Serviceless</a></li></ul></nav></div></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2024-06-02T11:22:56.000Z" title="02/06/2024, 9:22:56 pm">2024-06-02</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-06-01T23:43:59.253Z" title="02/06/2024, 9:43:59 am">2024-06-02</time></span><span class="level-item"><a class="link-muted" href="/en/categories/Explorations/">Explorations</a></span><span class="level-item">6 minutes read (About 885 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/en/2024/06/02/DynamoDB%20single%20table%20design/">DynamoDB the Advantages and Considerations of Single Table Design</a></p><div class="content"><p>Developers familiar with Relational Database design often find themselves initially drawn to the familiar territory of normalization when designing data models for DynamoDB. This instinct typically leads them towards what’s known as multi-table design, where each entity or relationship resides in a separate table.</p>
<p>On the other hand, DynamoDB’s schemaless nature encourages a different approach: single-table design, where all entities and relationships coexist within a single table. However, it’s worth noting that these two designs represent extremes on a spectrum, rather than strict boundaries.</p>
<p>According to the <a target="_blank" rel="noopener" href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/data-modeling-foundations.html">official documentation</a>, single-table design is often recommended. This article explores the advantages of single-table design based on practical experience.</p>
<p>Our project predominantly utilizes single-table design, largely influenced by 《The DynamoDB Book》, authored by advocate Alex DeBrie. Despite our commitment to single-table design, we still manage more than a dozen tables, albeit with a focus on storing related entities together.</p></div><a class="article-more button is-small is-size-7" href="/en/2024/06/02/DynamoDB%20single%20table%20design/#more">Read more</a></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2024-05-21T11:22:56.000Z" title="21/05/2024, 9:22:56 pm">2024-05-21</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-05-22T09:34:29.084Z" title="22/05/2024, 7:34:29 pm">2024-05-22</time></span><span class="level-item"><a class="link-muted" href="/en/categories/Explorations/">Explorations</a></span><span class="level-item">3 minutes read (About 511 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/en/2024/05/21/AWS-connect-last-agent-call-routing/">AWS connect last agent call routing</a></p><div class="content"><h2 id="Challenge"><a href="#Challenge" class="headerlink" title="Challenge"></a>Challenge</h2><p>In a recent project, we were assigned the task to route calls to the last agent who interacted with the caller.<br>This requirement may seem fundamental, but it proved to be more complex than anticipated,<br>especially considering its integration into Salesforce via Salesforce Service Cloud Voice.</p></div><a class="article-more button is-small is-size-7" href="/en/2024/05/21/AWS-connect-last-agent-call-routing/#more">Read more</a></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2024-05-16T13:17:22.000Z" title="16/05/2024, 11:17:22 pm">2024-05-16</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-05-17T06:27:00.408Z" title="17/05/2024, 4:27:00 pm">2024-05-17</time></span><span class="level-item"><a class="link-muted" href="/en/categories/Explorations/">Explorations</a></span><span class="level-item">2 minutes read (About 318 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/en/2024/05/16/AWS-client-getaddrinfo-EMFILE-issue/">AWS client getaddrinfo EMFILE issue</a></p><div class="content"><p>Recently, we introduced AWS Cloud Map for service discovery, primarily to retrieve queue URLs. However, after deployment, we encountered intermittent errors weeks later, logged as getaddrinfo EMFILE events.ap-southeast-2.amazonaws.com. Not all requests triggered this error, indicating a selective issue.</p>
<p>Upon inspection, it became apparent that we were facing a socket timeout problem, a known issue in our setup. The remedy was simple: reusing our existing agent.</p></div><a class="article-more button is-small is-size-7" href="/en/2024/05/16/AWS-client-getaddrinfo-EMFILE-issue/#more">Read more</a></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2024-05-10T21:52:05.000Z" title="11/05/2024, 7:52:05 am">2024-05-11</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-05-16T12:28:10.266Z" title="16/05/2024, 10:28:10 pm">2024-05-16</time></span><span class="level-item"><a class="link-muted" href="/en/categories/Explorations/">Explorations</a></span><span class="level-item">4 minutes read (About 551 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/en/2024/05/11/How-to-prevent-duplicate-SQS-messages/">How to prevent duplicate SQS messages</a></p><div class="content"><h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>In our system, queue processors must implement idempotency to prevent the double-processing of messages. Duplicate messages may arise in the following scenarios:</p>
<ol>
<li><p><strong>Scheduler and Message Producer</strong>: The scheduler or message producer may be triggered multiple times, occasionally rerunning due to timeouts.</p>
</li>
<li><p><strong>Queue Management</strong>: If a lambda instance times out while processing a message, another instance may retrieve the same message if the visibility timeout is not properly set.</p>
</li>
</ol>
<p>This can have terrible consequences. We aim to avoid sending duplicate emails or messages to our customers, not to mention inadvertently delivering duplicate gift cards.</p>
<p>So a generic idempotency mechanism is required.</p></div><a class="article-more button is-small is-size-7" href="/en/2024/05/11/How-to-prevent-duplicate-SQS-messages/#more">Read more</a></article></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/en/gallery/site/shark.png" alt="Fedeoo"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Fedeoo</p><p class="is-size-6 is-block">Engineer</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Sydney</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/en/archives"><p class="title">7</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Category</p><a href="/en/categories"><p class="title">1</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/en/tags"><p class="title">12</p></a></div></div></nav></div></div><!--!--><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/en/categories/Explorations/"><span class="level-start"><span class="level-item">Explorations</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><figure class="media-left"><a class="image" href="/en/2024/06/02/DynamoDB%20single%20table%20design/"><img src="/en/gallery/thumbnails/2024/dynamodb.png" alt="DynamoDB the Advantages and Considerations of Single Table Design"></a></figure><div class="media-content"><p class="date"><time dateTime="2024-06-02T11:22:56.000Z">2024-06-02</time></p><p class="title"><a href="/en/2024/06/02/DynamoDB%20single%20table%20design/">DynamoDB the Advantages and Considerations of Single Table Design</a></p><p class="categories"><a href="/en/categories/Explorations/">Explorations</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/en/2024/05/21/AWS-connect-last-agent-call-routing/"><img src="/en/gallery/thumbnails/2024/call-center.png" alt="AWS connect last agent call routing"></a></figure><div class="media-content"><p class="date"><time dateTime="2024-05-21T11:22:56.000Z">2024-05-21</time></p><p class="title"><a href="/en/2024/05/21/AWS-connect-last-agent-call-routing/">AWS connect last agent call routing</a></p><p class="categories"><a href="/en/categories/Explorations/">Explorations</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/en/2024/05/16/AWS-client-getaddrinfo-EMFILE-issue/"><img src="/en/gallery/thumbnails/aws/lambda.png" alt="AWS client getaddrinfo EMFILE issue"></a></figure><div class="media-content"><p class="date"><time dateTime="2024-05-16T13:17:22.000Z">2024-05-16</time></p><p class="title"><a href="/en/2024/05/16/AWS-client-getaddrinfo-EMFILE-issue/">AWS client getaddrinfo EMFILE issue</a></p><p class="categories"><a href="/en/categories/Explorations/">Explorations</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/en/2024/05/11/How-to-prevent-duplicate-SQS-messages/"><img src="/en/gallery/thumbnails/2024/sqs.png" alt="How to prevent duplicate SQS messages"></a></figure><div class="media-content"><p class="date"><time dateTime="2024-05-10T21:52:05.000Z">2024-05-11</time></p><p class="title"><a href="/en/2024/05/11/How-to-prevent-duplicate-SQS-messages/">How to prevent duplicate SQS messages</a></p><p class="categories"><a href="/en/categories/Explorations/">Explorations</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/en/2020/02/14/novice/cache-memory-issue/"><img src="/en/gallery/thumbnails/troubleshooting.jpg" alt="A bug which should have been solved a week ago"></a></figure><div class="media-content"><p class="date"><time dateTime="2020-02-14T11:05:00.000Z">2020-02-14</time></p><p class="title"><a href="/en/2020/02/14/novice/cache-memory-issue/">A bug which should have been solved a week ago</a></p><p class="categories"><a href="/en/categories/Explorations/">Explorations</a></p></div></article></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/en/tags/Serviceless/"><span class="tag">Serviceless</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/en/tags/AWS/"><span class="tag">AWS</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/en/tags/FE/"><span class="tag">FE</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/en/tags/Client/"><span class="tag">Client</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/en/tags/Amazon-connect/"><span class="tag">Amazon connect</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/en/tags/DynamoDB/"><span class="tag">DynamoDB</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/en/tags/SQS-Processor/"><span class="tag">SQS Processor</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/en/tags/Auth0/"><span class="tag">Auth0</span><span class="tag">1</span></a></div></div></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/en/"><img src="/en/gallery/site/logo.png" alt="Fedeoo&#039;s Blog" height="28"></a><p class="is-size-7"><span>&copy; 2024 Fedeoo</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/en/js/column.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/en/js/back_to_top.js" defer></script><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/javascript" id="MathJax-script" async>MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      },
      chtml: {
        matchFontHeight: false
      }
    };</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js"></script><!--!--><!--!--><!--!--><script src="/en/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/en/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/en/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>