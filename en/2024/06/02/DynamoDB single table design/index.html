<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="google-site-verification" content="aG_tXROG9wF9yK4g29KmnltUUXyLK5SBAWKIXDkz6vU"><title>DynamoDB the Advantages and Considerations of Single Table Design - Fedeoo&#039;s Blog</title><link rel="manifest" href="/en/manifest.json"><meta name="application-name" content="Fedeoo&#039;s Blog"><meta name="msapplication-TileImage" content="/gallery/site/shark.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Fedeoo&#039;s Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Developers familiar with Relational Database design often find themselves initially drawn to the familiar territory of normalization when designing data models for DynamoDB. This instinct typically le"><meta property="og:type" content="blog"><meta property="og:title" content="DynamoDB the Advantages and Considerations of Single Table Design"><meta property="og:url" content="http://blog.feibyte.com/en/2024/06/02/DynamoDB%20single%20table%20design/"><meta property="og:site_name" content="Fedeoo&#039;s Blog"><meta property="og:description" content="Developers familiar with Relational Database design often find themselves initially drawn to the familiar territory of normalization when designing data models for DynamoDB. This instinct typically le"><meta property="og:locale" content="en_US"><meta property="og:image" content="http://blog.feibyte.com/en/gallery/thumbnails/2024/dynamodb.png"><meta property="article:published_time" content="2024-06-02T11:22:56.000Z"><meta property="article:modified_time" content="2024-06-01T23:43:59.253Z"><meta property="article:author" content="Fedeoo"><meta property="article:tag" content="Serviceless"><meta property="article:tag" content="DynamoDB"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="http://blog.feibyte.com/en/gallery/thumbnails/2024/dynamodb.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://blog.feibyte.com/en/2024/06/02/DynamoDB%20single%20table%20design/"},"headline":"DynamoDB the Advantages and Considerations of Single Table Design","image":["http://blog.feibyte.com/en/gallery/thumbnails/2024/dynamodb.png"],"datePublished":"2024-06-02T11:22:56.000Z","dateModified":"2024-06-01T23:43:59.253Z","author":{"@type":"Person","name":"Fedeoo"},"publisher":{"@type":"Organization","name":"Fedeoo's Blog","logo":{"@type":"ImageObject","url":"http://blog.feibyte.com/gallery/site/logo.png"}},"description":"Developers familiar with Relational Database design often find themselves initially drawn to the familiar territory of normalization when designing data models for DynamoDB. This instinct typically le"}</script><link rel="canonical" href="http://blog.feibyte.com/en/2024/06/02/DynamoDB%20single%20table%20design/"><link rel="icon" href="/en/gallery/site/shark.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/en/css/default.css"><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=G-773NDPTQE0" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'G-773NDPTQE0');</script><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.2.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/en/"><img src="/en/gallery/site/logo.png" alt="Fedeoo&#039;s Blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/en/">Home</a><a class="navbar-item" href="/en/archives">Archives</a><a class="navbar-item" href="/en/categories">Categories</a><a class="navbar-item" href="/en/tags">Tags</a><a class="navbar-item" href="/en/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="简体中文" href="https://blog.feibyte.com/">简体中文</a><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/feibyte/feibyte.github.io"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2024-06-02T11:22:56.000Z" title="6/2/2024, 9:22:56 PM">2024-06-02</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-06-01T23:43:59.253Z" title="6/2/2024, 9:43:59 AM">2024-06-02</time></span><span class="level-item"><a class="link-muted" href="/en/categories/Explorations/">Explorations</a></span><span class="level-item">6 minutes read (About 885 words)</span></div></div><h1 class="title is-3 is-size-4-mobile">DynamoDB the Advantages and Considerations of Single Table Design</h1><div class="content"><p>Developers familiar with Relational Database design often find themselves initially drawn to the familiar territory of normalization when designing data models for DynamoDB. This instinct typically leads them towards what’s known as multi-table design, where each entity or relationship resides in a separate table.</p>
<p>On the other hand, DynamoDB’s schemaless nature encourages a different approach: single-table design, where all entities and relationships coexist within a single table. However, it’s worth noting that these two designs represent extremes on a spectrum, rather than strict boundaries.</p>
<p>According to the <a target="_blank" rel="noopener" href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/data-modeling-foundations.html">official documentation</a>, single-table design is often recommended. This article explores the advantages of single-table design based on practical experience.</p>
<p>Our project predominantly utilizes single-table design, largely influenced by 《The DynamoDB Book》, authored by advocate Alex DeBrie. Despite our commitment to single-table design, we still manage more than a dozen tables, albeit with a focus on storing related entities together.</p>
<span id="more"></span>

<h2 id="Advantages-of-single-table-design"><a href="#Advantages-of-single-table-design" class="headerlink" title="Advantages of single table design"></a>Advantages of single table design</h2><h3 id="1-Data-Locality-for-Efficient-Queries"><a href="#1-Data-Locality-for-Efficient-Queries" class="headerlink" title="1. Data Locality for Efficient Queries"></a>1. Data Locality for Efficient Queries</h3><p>Single-table design allows for fetching multiple entity types in a single database call, reducing requests, improving performance, and cutting costs. However, realizing this advantage in practice requires deliberate structuring, as applications often overlook underlying implementation details.</p>
<p>In the table below, user information and order information use the same <code>Partition Key</code>, in the same <code>itemCollection</code>, you can get user information and order information in one <code>Query</code> request.</p>
<p><img src="/en/gallery/site/2024/single-table.png" alt="single-table.png"></p>
<p>The problem in reality: realizing this advantage in practice requires deliberate structuring, as applications often overlook the underlying implementation details.<br>In practice, we don’t care about the order of entity types in the same <code>itemCollection</code>, usually still keep 2 requests for different entities each in same <code>itemCollection</code>.</p>
<h3 id="2-Reduces-overall-financial-and-latency-costs-of-reads"><a href="#2-Reduces-overall-financial-and-latency-costs-of-reads" class="headerlink" title="2. Reduces overall financial and latency costs of reads:"></a>2. Reduces overall financial and latency costs of reads:</h3><blockquote>
<p>A single query for two items totalling less than 4KB is 0.5 RCU eventually consistent<br>Two queries for two items totalling less than 4KB is 1 RCU eventually consistent (0.5 RCU each)<br>The time to return two separate database calls will average higher than a single call</p>
</blockquote>
<p>The advantages of the bill are quite obvious: reducing the number of requests naturally reduces the cost of the bill, usually a single entity record will not be very large, and multiple entity records may not necessarily have 4KB.<br>The advantage of latency is also easy to understand, a single request is usually faster than two separate requests.</p>
<p>However, this advantage based on assumptions that you can save another request call, which is not always the case in practice.</p>
<h3 id="3-Reduces-the-number-of-tables-to-manage"><a href="#3-Reduces-the-number-of-tables-to-manage" class="headerlink" title="3. Reduces the number of tables to manage:"></a>3. Reduces the number of tables to manage:</h3><blockquote>
<p>Permissions do not need to be maintained across multiple IAM roles or policies<br>Capacity management for the table is averaged across all entities, usually resulting in a more predictable consumption pattern<br>Monitoring requires fewer alarms<br>Customer Managed Encryption Keys only need to be rotated on one table</p>
</blockquote>
<p>Permissions do not need to be maintained across multiple IAM roles or policies, which also means that the granularity of permissions is not so fine. In practice, we already feel that our permissions are too fine, and each Lambda has different role permissions.<br>These advantages are real, single-table design is easier to manage, does not require more configuration, and does not require access permissions for each table in each Lambda.</p>
<h3 id="4-Smooths-traffic-to-the-table"><a href="#4-Smooths-traffic-to-the-table" class="headerlink" title="4. Smooths traffic to the table:"></a>4. Smooths traffic to the table:</h3><blockquote>
<p>By aggregating multiple usage patterns to the same table, the overall usage tends to be smoother (the way a stock index’s performance tends to be smoother than any individual stock) which works better for achieving higher utilization with provisioned mode tables<br>Not much to say, the advantage is not obvious in practice</p>
</blockquote>
<h2 id="Disadvantages"><a href="#Disadvantages" class="headerlink" title="Disadvantages"></a>Disadvantages</h2><ol>
<li>Learning curve can be steep due to paradoxical design compared to relational databases<br>Understanding the fundamental principles of DynamoDB, grasping the single-table design concept isn’t overly complex. However, there are associated trade-offs to consider, and the learning curve isn’t particularly steep. In our experience, incorporating a new entity type into an existing table proves far simpler than introducing a new table altogether.</li>
<li>Data requirements must be consistent across all entity types</li>
<li>All changed data will be propagated to DynamoDB Streams even if only a subset of entities need to be processed.</li>
<li>When using GraphQL, single table design will be more difficult to implement</li>
<li>When using higher-level SDK clients like Java’s DynamoDBMapper or Enhanced Client, it can be more difficult to process results because items in the same response may be associated with different classes</li>
</ol>
<h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><p>DynamoDB’s flexibility allows for a spectrum of design choices, with no strict delineation between single-table and multi-table approaches. Advocates typically recommend a per-service table, challenging developers to break free from the relational database mindset.</p>
<p>Understanding DynamoDB’s core concepts is essential. From there, the choice between single-table and multi-table design should align with specific project requirements.</p>
<p>For further exploration:</p>
<ol>
<li><a target="_blank" rel="noopener" href="https://aws.amazon.com/blogs/database/single-table-vs-multi-table-design-in-amazon-dynamodb/">Single-table vs. multi-table design in Amazon DynamoDB
</a></li>
<li><a target="_blank" rel="noopener" href="https://www.gomomento.com/blog/single-table-design-for-dynamodb-the-reality">Single table design for DynamoDB: The reality</a></li>
<li><a target="_blank" rel="noopener" href="https://www.alexdebrie.com/posts/dynamodb-single-table/">The What, Why, and When of Single-Table Design with DynamoDB</a></li>
</ol>
</div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/en/tags/Serviceless/">Serviceless</a><a class="link-muted mr-2" rel="tag" href="/en/tags/DynamoDB/">DynamoDB</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/en/2024/05/21/AWS-connect-last-agent-call-routing/"><span class="level-item">AWS connect last agent call routing</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div><script>var disqus_config = function () {
            this.page.url = 'http://blog.feibyte.com/en/2024/06/02/DynamoDB%20single%20table%20design/';
            this.page.identifier = '2024/06/02/DynamoDB single table design/';
        };
        (function() {
            var d = document, s = d.createElement('script');  
            s.src = '//' + 'blog-feibyte-com' + '.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/en/gallery/site/shark.png" alt="Fedeoo"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Fedeoo</p><p class="is-size-6 is-block">Engineer</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Sydney</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/en/archives"><p class="title">7</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Category</p><a href="/en/categories"><p class="title">1</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/en/tags"><p class="title">12</p></a></div></div></nav></div></div><!--!--><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/en/categories/Explorations/"><span class="level-start"><span class="level-item">Explorations</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><figure class="media-left"><a class="image" href="/en/2024/06/02/DynamoDB%20single%20table%20design/"><img src="/en/gallery/thumbnails/2024/dynamodb.png" alt="DynamoDB the Advantages and Considerations of Single Table Design"></a></figure><div class="media-content"><p class="date"><time dateTime="2024-06-02T11:22:56.000Z">2024-06-02</time></p><p class="title"><a href="/en/2024/06/02/DynamoDB%20single%20table%20design/">DynamoDB the Advantages and Considerations of Single Table Design</a></p><p class="categories"><a href="/en/categories/Explorations/">Explorations</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/en/2024/05/21/AWS-connect-last-agent-call-routing/"><img src="/en/gallery/thumbnails/2024/call-center.png" alt="AWS connect last agent call routing"></a></figure><div class="media-content"><p class="date"><time dateTime="2024-05-21T11:22:56.000Z">2024-05-21</time></p><p class="title"><a href="/en/2024/05/21/AWS-connect-last-agent-call-routing/">AWS connect last agent call routing</a></p><p class="categories"><a href="/en/categories/Explorations/">Explorations</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/en/2024/05/16/AWS-client-getaddrinfo-EMFILE-issue/"><img src="/en/gallery/thumbnails/aws/lambda.png" alt="AWS client getaddrinfo EMFILE issue"></a></figure><div class="media-content"><p class="date"><time dateTime="2024-05-16T13:17:22.000Z">2024-05-16</time></p><p class="title"><a href="/en/2024/05/16/AWS-client-getaddrinfo-EMFILE-issue/">AWS client getaddrinfo EMFILE issue</a></p><p class="categories"><a href="/en/categories/Explorations/">Explorations</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/en/2024/05/11/How-to-prevent-duplicate-SQS-messages/"><img src="/en/gallery/thumbnails/2024/sqs.png" alt="How to prevent duplicate SQS messages"></a></figure><div class="media-content"><p class="date"><time dateTime="2024-05-10T21:52:05.000Z">2024-05-11</time></p><p class="title"><a href="/en/2024/05/11/How-to-prevent-duplicate-SQS-messages/">How to prevent duplicate SQS messages</a></p><p class="categories"><a href="/en/categories/Explorations/">Explorations</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/en/2020/02/14/novice/cache-memory-issue/"><img src="/en/gallery/thumbnails/troubleshooting.jpg" alt="A bug which should have been solved a week ago"></a></figure><div class="media-content"><p class="date"><time dateTime="2020-02-14T11:05:00.000Z">2020-02-14</time></p><p class="title"><a href="/en/2020/02/14/novice/cache-memory-issue/">A bug which should have been solved a week ago</a></p><p class="categories"><a href="/en/categories/Explorations/">Explorations</a></p></div></article></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/en/tags/Serviceless/"><span class="tag">Serviceless</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/en/tags/AWS/"><span class="tag">AWS</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/en/tags/FE/"><span class="tag">FE</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/en/tags/Client/"><span class="tag">Client</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/en/tags/Amazon-connect/"><span class="tag">Amazon connect</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/en/tags/DynamoDB/"><span class="tag">DynamoDB</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/en/tags/SQS-Processor/"><span class="tag">SQS Processor</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/en/tags/Auth0/"><span class="tag">Auth0</span><span class="tag">1</span></a></div></div></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/en/"><img src="/en/gallery/site/logo.png" alt="Fedeoo&#039;s Blog" height="28"></a><p class="is-size-7"><span>&copy; 2024 Fedeoo</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/en/js/column.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/en/js/back_to_top.js" defer></script><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/javascript" id="MathJax-script" async>MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      },
      chtml: {
        matchFontHeight: false
      }
    };</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js"></script><!--!--><!--!--><!--!--><script src="/en/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/en/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/en/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>